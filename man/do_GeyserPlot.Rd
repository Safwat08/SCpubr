% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/do_GeyserPlot.R
\name{do_GeyserPlot}
\alias{do_GeyserPlot}
\title{Generate a Geyser plot.}
\usage{
do_GeyserPlot(
  sample,
  features,
  assay = NULL,
  slot = "data",
  group.by = NULL,
  split.by = NULL,
  symmetrical_scale = FALSE,
  scale_type = "continuous",
  color.by = NULL,
  order_by_mean = TRUE,
  plot_cell_borders = TRUE,
  jitter = 0.45,
  pt.size = 1,
  border.size = 2,
  border.color = "black",
  legend.position = "bottom",
  legend.width = 1,
  legend.length = 20,
  legend.framewidth = 1.5,
  legend.tickwidth = 1.5,
  legend.framecolor = "grey50",
  legend.tickcolor = "white",
  legend.type = "colorbar",
  font.size = 14,
  font.type = "sans",
  rotate_x_axis_labels = FALSE,
  viridis_color_map = "D",
  colors.use = NULL,
  na.value = "grey75",
  legend.ncol = NULL,
  legend.nrow = NULL,
  legend.icon.size = 4,
  legend.byrow = FALSE,
  legend.title = NULL,
  show_legend = TRUE,
  plot.title = NULL,
  plot.subtitle = NULL,
  plot.caption = NULL,
  xlab = NULL,
  ylab = NULL
)
}
\arguments{
\item{sample}{Seurat object.}

\item{features}{Character. Features to plot.}

\item{assay}{Character. Assay to use. Defaults to active assay if not.}

\item{slot}{Character. Slot to use. Defaults to data slot if not.}

\item{group.by}{Character. Metadata variable to group the data by.}

\item{split.by}{Character. Metadata variable to further split the plot by.}

\item{symmetrical_scale}{Logical. Whether you want a continuous scale that is symmetrical on both ends and the intensity of the colors in each end matches (blue to red).}

\item{scale_type}{Character. Either continuous or categorical.}

\item{color.by}{Character. Vector of colors to color the groups by if scale_type is categorical.}

\item{order_by_mean}{Logical. Whether to order the groups by the mean of the data (highest to lowest).}

\item{plot_cell_borders}{Logical. Whether to plot border around the cells.}

\item{jitter}{Numeric. Amount of jitter in the plot along the X axis. The lower the value, the more compacted the dots are.}

\item{pt.size}{Numeric. Size of the cells.}

\item{border.size}{Numeric. Thickness of the border around the cells.}

\item{border.color}{Character. Color for the border of the cells.}

\item{legend.position}{Character. Position of the legend in the plot. Will only work if legend is set to TRUE.}

\item{legend.length, legend.width}{Numeric. Length and width of the legend. Will adjust automatically depending on legend side.}

\item{legend.framewidth, legend.tickwidth}{Numeric. Width of the lines of the box in the legend.}

\item{legend.framecolor, legend.tickcolor}{Character. Color of the lines of the box in the legend.}

\item{legend.type}{Character. Type of legend to display. One of: normal, colorbar, colorsteps.}

\item{font.size}{Numeric. Overall font size of the plot.}

\item{font.type}{Character. Font family for the plot: sans, mono, serif.}

\item{rotate_x_axis_labels}{Logical. Whether to rotate X axis labels.}

\item{viridis_color_map}{Character. Viridis color map to use. One of: A, B, C, D, E, F, G, H.}

\item{colors.use}{Character. Named vector of colors to use. Has to match the unique values of group.by or color.by (if used) when scale_type is set to categorical.}

\item{na.value}{Character. Color for NAs.}

\item{legend.ncol, legend.nrow}{Numeric. Number of rows/columns of a categorical legend.}

\item{legend.icon.size}{Numeric. Size of the dots in a categorical legend.}

\item{legend.byrow}{Logical. Whether to fill the legend by rows instead of columns in a categorical legend.}

\item{legend.title}{Character. Title for the legend.}

\item{show_legend}{Logical. Whether to display the legend. Might be redundant depending on the setups.}

\item{plot.title, plot.subtitle, plot.caption}{Character. Title, Subtitle and caption to use in the plot.}

\item{xlab, ylab}{Character. Titles for the X and Y axis.}
}
\value{
Either a plot of a list of plots, depending on the number of features provided.
}
\description{
A Geyser plot is a custom plot in which we plot continuous values on the Y axis grouped by a categorical value in the X. This is plotted as a dot plot, jittered so that the dots span
all the way to the other groups. On top of this, the mean and .66 and .95 of the data is plotted, depicting the overall distribution of the dots. The cells can, then, be colored by
a continuous variable (same as Y axis or different) or a categorical one (same as X axis or different).
}
\details{
Special thanks to Christina Blume for coming up with the name of the plot.
}
\examples{
\dontrun{
  # Geyser plot with categorical color scale.
  p1 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "nCount_RNA",
                              scale_type = "categorical")

  # Geyser plot with continuous color scale.
  p2 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "nCount_RNA",
                              scale_type = "continuous")


  p <- p1 / p2
  p

  # Geyser plot with categorical color scale without ordering by mean.
  p1 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "nCount_RNA",
                              scale_type = "categorical",
                              order_by_mean = FALSE)

  # Geyser plot with continuous color scale without ordering by mean.
  p2 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "nCount_RNA",
                              scale_type = "continuous",
                              order_by_mean = FALSE)


  p <- p1 / p2
  p

  # Geyser plot with continuous color scale.
  p1 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = FALSE)

  # Geyser plot with continuous and symmetrical color scale.
  p2 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = TRUE)


  p <- p1 / p2
  p

  # Geyser plot with categorical color scale default X axis grouping.
  p1 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "categorical",
                              group.by = NULL,
                              xlab = "Seurat clusters")

  # Geyser plot with categorical color scale and custom grouping.
  p2 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "categorical",
                              group.by = "orig.ident",
                              xlab = "Individual sample")


  p <- p1 / p2
  p

  # We only have one value in orig.ident. Let's modify it so that it resembles a multi-sample Seurat object.
  sample$modified_orig.ident <- sample(x = c("Sample_A", "Sample_B", "Sample_C"),
                                       size = ncol(sample),
                                       replace = T,
                                       prob = c(0.2, 0.7, 0.1))

  # Geyser plot with categorical color scale split by seurat clusters.
  p1 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "categorical",
                              group.by = "modified_orig.ident",
                              split.by = "seurat_clusters")

  # Geyser plot with continuous color scale split by seurat clusters.
  p2 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              group.by = "modified_orig.ident",
                              split.by = "seurat_clusters")


  p <- p1 / p2
  p

  # Geyser plot with categorical color scale split by seurat clusters rotating labels.
  p1 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "categorical",
                              group.by = "modified_orig.ident",
                              split.by = "seurat_clusters",
                              rotate_x_axis_labels = TRUE)

  # Geyser plot with continuous color scale split by seurat clusters rotating labels.
  p2 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = TRUE,
                              group.by = "modified_orig.ident",
                              split.by = "seurat_clusters",
                              rotate_x_axis_labels = TRUE)


  p <- p1 / p2
  p

  # Geyser plot with categorical color scale using color.by.
  p1 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "categorical",
                              color.by = "modified_orig.ident")

  # Geyser plot with continuous color scale using color.by.
  p2 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = TRUE,
                              color.by = "nCount_RNA")


  p <- p1 / p2
  p

  # Geyser plot with categorical color scale using color.by and split.by.
  p1 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "categorical",
                              group.by = "orig.ident",
                              split.by = "seurat_clusters",
                              color.by = "modified_orig.ident")

  # Geyser plot with continuous color scale using color.by and split.by.
  p2 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = TRUE,
                              color.by = "nCount_RNA",
                              group.by = "orig.ident",
                              split.by = "seurat_clusters")


  p <- p1 / p2
  p

  # Geyser plot with different jitter.
  p0 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = TRUE,
                              jitter = 0.01)

  p1 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = TRUE,
                              jitter = 0.1)

  p2 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = TRUE,
                              jitter = 0.2)

  p3 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = TRUE,
                              jitter = 0.3)

  p4 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = TRUE,
                              jitter = 0.4)

  p5 <- SCpubr::do_GeyserPlot(sample = sample,
                              features = "UMAP_2",
                              scale_type = "continuous",
                              symmetrical_scale = TRUE,
                              jitter = 0.49)


  p <- p0 / p1 / p2 / p3 / p4 / p5
  p
}
}
